def preset():
    import pandas as pd
    file_path1 = "/Users/chunghimlau/Desktop/Python/ck.csv"
    file_path2 = "/Users/chunghimlau/Desktop/Python/ckcolor.csv"
    df1 = pd.read_csv(file_path1)
    df2 = pd.read_csv(file_path2)
    print(df1.columns)
    print(df2.columns)
    #Reset the index and column
    #Turn dataframe to a dictionary where the keys are columns and values are lists of column data
    dict1 = df1.set_index('excel_item_id').T.to_dict('list')
    dict2 = df2.set_index('itemcolour_id').T.to_dict('list')
    print(dict1)
    print(dict2)
    
   

def checkorean(): 
    input1 = input()
    
    #collect item id after entering "Order"
    if input1 == "order":
        order_list.clear()
        total = 0
        
        #Enter done to end the order, otherwise keep checking the input
        while True:
            item_key = input("ã€Šè«‹è¼¸å…¥ç”¢å“ç·¨è™Ÿã€‹\n\n*è‹¥è¦çµç®—è«‹è¼¸å…¥ done\n\n")
            if item_key == "done":
                break
            else:
                #Testing input type, only pass when it is a number
                try:
                    id_num = int(item_key)
                    #Test input meaning, whether it is normal number of item_key
               
                    if id_num in dict1:
                        print(dict2[id_num])
                        input_color = (input("ä½ æƒ³è¦å’©é¡è‰² "))
                        
                         #Test input color, whether it is belong to the item_key
                        if input_color in dict2[id_num]:
                            price = dict1[id_num][0]
                            #add to order_list
                            order_list.append(id_num)
                            order_list.append(input_color)
                        else:
                            price = 0
                            print("++++++++++ä½ è¼¸å…¥çš„é¡è‰²ä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")
                    else: 
                        price = 0
                        print("++++++++++ä½ è¼¸å…¥çš„ç·¨è™Ÿä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")
                
                except:
                    price = 0
                    print("++++++++++ä½ è¼¸å…¥çš„ç·¨è™Ÿ1ä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")
                total += price
      
        print("\n\nğŸ‘¦ğŸ»CheckoreanğŸ‡°ğŸ‡·ä»˜æ¬¾æ–¹æ³• ğŸ‘§ğŸ»\n-é€¢æ˜ŸæœŸå››æˆªå–®-\næœªå…¥æ•¸å˜…æœ‰æ©Ÿæœƒæœƒå†‡è²¨ğŸ¤®è¨˜ä½å¿«å•²å…¥\nå…¥å®Œæ•¸å†‡è²¨å˜…è©±åº—ä¸»æœƒè¦ªè‡ªè¯çµ¡é€€æ¬¾å®‰æ’ğŸ¤ğŸ»\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nğŸ’°",total,"\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nâ€¼ï¸å…¥æ•¸ä¹‹å¾Œâ€¼ï¸\nè«‹å°‡æ”¶æ“šè¨¼æ˜sendä¿¾æˆ‘åœ°ğŸ˜›\nThankyouuu~\n1âƒ£åŒ¯è±éŠ€è¡Œ\n661-324-574-833\n2ï¸âƒ£è½‰æ•¸å¿«/ PAYME\n+852 64874030ï¼ˆâš ï¸æ³¨æ„ï¼‰\nhttps://payme.hsbc/checkorean\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nğŸ”¥å–è²¨ä¿¡æ¯ğŸ”¥ è«‹æŒ‰ä»¥ä¸‹æ ¼å¼å¡«å¯«\n1âƒ£ï¸.é †è±åˆ°ä»˜ ( æ™ºèƒ½æ«ƒ / SFé–€å¸‚ )\nğŸ§šğŸ»â€â™€ï¸æ”¶ä»¶äºº: Karen Lau \nâ˜ï¸Tel: 56265394\n é †è±ç·¨ç¢¼: 852UA27P\n2âƒ£ï¸.å¹³éƒµ(é©ç”¨æ–¼è³¼ç‰©æ»¿$300ä»¥ä¸Š\nğŸŒŸè¨»ï¼šéƒµè²»å°‡æ–¼å¯„è²¨å¾Œå†å‘å®¢äººæ”¶å–\nğŸ§šğŸ»â€â™€ï¸æ”¶ä»¶äºº: Karen Lau\n â˜ï¸Tel: 56265394\nåœ°å€: xxxxxxxxxxxx\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nâš ï¸é¡§å®¢é ˆçŸ¥\n1âƒ£ï¸æ­¤ç‚ºé è¨‚å•†å“ æˆªå–®å¾Œ2-3æ˜ŸæœŸå‡ºè²¨ è«‹è€å¿ƒç­‰å¾…âŒ›ğŸ™ğŸ»\n2âƒ£ï¸è‹¥å‡ºç¾è½å–®å¾Œç¼ºè²¨ç­‰æƒ…æ³ æœƒå‘å®¢äººé€€å›è©²å•†å“å…¨æ•¸æ¬¾é …\n3âƒ£ï¸å°åº—æœƒè¦ªè‡ªè¯çµ¡é¡§å®¢é€€æ¬¾å®‰æ’ğŸ¥º\n \nå¤šè¬ä½ å˜…æ”¯æŒğŸ™ˆä½ å˜…æ”¯æŒæœƒæˆç‚ºæˆ‘åœ°å˜…å‹•åŠ›ğŸ¤")
    else: print("è½å–®è«‹è¼¸å…¥order")
def toexcel():
    print(order_list)
    out_df = pd.DataFrame([order_list])
    from openpyxl import load_workbook
    # new dataframe with same columns
    writer = pd.ExcelWriter('output.xlsx', engine='openpyxl')
    # try to open an existing workbook
    writer.book = load_workbook('output.xlsx')
    # copy existing sheets
    writer.sheets = dict((ws.title, ws) for ws in writer.book.worksheets)
    # read existing file
    reader = pd.read_excel(r'output.xlsx')
    # write out the new sheet
    out_df.to_excel(writer,index=False,header=False,startrow=len(reader)+1)

    writer.close()
    print("Exported to Excel")
preset()
checkorean()
toexcel()
