import warnings
warnings.filterwarnings("ignore")
def chec():
    import pandas as pd
    import numpy as np
    file_path1 = "/Users/chunghimlau/Desktop/Python/ck.xlsx"
    file_path2 = "/Users/chunghimlau/Desktop/Python/ck.xlsx"
    file_path3 = "/Users/chunghimlau/Desktop/Python/ck.xlsx"
    file_path4 = "/Users/chunghimlau/Desktop/Python/ck.xlsx"
    #build dataframe
    df1 = pd.read_excel(file_path1,sheet_name = "code_id_price")
    df1 = df1.replace(np.nan,"")
    df1 = df1.replace("<-","")
    df2 = pd.read_excel(file_path2,sheet_name = "code_color")
    df2 = df2.replace(np.nan,"")
    df2 = df2.replace("<-","")
    df3 = pd.read_excel(file_path3,sheet_name = "code_product_name")
    df3 = df3.replace(np.nan,"")
    df3 = df3.replace("<-","")
    df4 = pd.read_excel(file_path4,sheet_name = "code_size")
    df4 = df4.replace(np.nan,"")
    df4 = df4.replace("<-","")
    print(df1.columns)
    print(df2.columns)
    print(df3.columns)
    print(df4.columns)
    
    #set key = id value = column(list all value)
    dict1 = df1.set_index('excel_item_id').T.to_dict('list')
    dict2 = df2.set_index('itemcolour_id').T.to_dict('list')
    dict3 = df3.set_index('item_name_id').T.to_dict('list')
    dict4 = df4.set_index('item_name_id').T.to_dict('list')
    #print(dict1)
    #print(dict2)
    #print(dict3)
    #print(dict4)
    order_list = []
    input1 = input()

    #å¦‚æžœè¼¸å…¥order å…ˆæœƒé–‹å§‹æ”¶é›†item code
    if input1 == "order":
        order_list.clear()
        total = 0

        #è¼¸å…¥item code å¦‚æžœå…¥doneæœƒexit loop
        while True:
            item_key = input("ã€Šè«‹è¼¸å…¥å•†å“ç·¨è™Ÿã€‹\n\n*è‹¥è¦çµç®—è«‹è¼¸å…¥ done\n\n")
            if item_key == "done":
                break
            else:
                #Test inputä¿‚å’ªæ•¸å­— å®šä¿‚å…¶ä»–
                try:
                    id_num = int(item_key)
                    #Test inputä¿‚å’ªitem key å®šä¿‚æ™®é€šæ•¸å­—
                    #å¦‚æžœä¿‚item key Addå…¥order list
                    if id_num in dict1:
                        #for i in dict2[id_num]:
                            #print(i,end = " ")
                        #Loop until the color and size is valid
                  
                        while True:
                            print("å•†å“åç¨±: ",dict3[id_num])
                            for i in dict2[id_num]:
                                if i == "":
                                    continue
                              
                                print("é¡è‰² âž¡ï¸",i)
                            input_color = (input("ä½ æƒ³è¦å’©é¡è‰² "))
                            output_color = input_color+"è‰²"
                            if input_color in dict2[id_num]:
                                break

                            else:
                                price = 0
                                print("++++++++++ä½ è¼¸å…¥çš„é¡è‰²ä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")

                        while True:
                            
                            if "free" in dict4[id_num]:
                                input_size = "Free"
                                output_size = "Free"
                            else:
                                for i in dict4[id_num]:
                                    if i == "":
                                        continue
                                    

                                    print("Size âž¡ï¸",i.upper())
                                input_size = (input("ä½ æƒ³è¦å’©Size "))
                                output_size = input_size
                                        
                            if input_size.lower() in dict4[id_num]:
                                price = dict1[id_num][0]
                                order_list.append(dict3[id_num][0])
                                order_list.append(output_color)
                                order_list.append(output_size.capitalize())
                                break

                            else:
                                price = 0
                                print("++++++++++ä½ è¼¸å…¥çš„Sizeä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")

                    else: 
                        price = 0
                        print("++++++++++ä½ è¼¸å…¥çš„ç·¨è™Ÿä¸æ­£ç¢º,è«‹é‡è©¦++++++++++++")

                except:
                    price = 0
                    print("++++++++++ä½ è¼¸å…¥ä¸æ˜¯æ•¸å­—,è«‹é‡è©¦++++++++++++")
                total += price

        print("\n\nðŸ‘¦ðŸ»CheckoreanðŸ‡°ðŸ‡·ä»˜æ¬¾æ–¹æ³• ðŸ‘§ðŸ»\n-é€¢æ˜ŸæœŸå››æˆªå–®-\næœªå…¥æ•¸å˜…æœ‰æ©Ÿæœƒæœƒå†‡è²¨ðŸ¤®è¨˜ä½å¿«å•²å…¥\nå…¥å®Œæ•¸å†‡è²¨å˜…è©±åº—ä¸»æœƒè¦ªè‡ªè¯çµ¡é€€æ¬¾å®‰æŽ’ðŸ¤ðŸ»\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nðŸ’°",total,"\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nâ€¼ï¸å…¥æ•¸ä¹‹å¾Œâ€¼ï¸\nè«‹å°‡æ”¶æ“šè¨¼æ˜Žsendä¿¾æˆ‘åœ°ðŸ˜›\nThankyouuu~\n1âƒ£åŒ¯è±éŠ€è¡Œ\n661-324-574-833\n2ï¸âƒ£è½‰æ•¸å¿«/ PAYME\n+852 64874030ï¼ˆâš ï¸æ³¨æ„ï¼‰\nhttps://payme.hsbc/checkorean\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nðŸ”¥å–è²¨ä¿¡æ¯ðŸ”¥ è«‹æŒ‰ä»¥ä¸‹æ ¼å¼å¡«å¯«\n1âƒ£ï¸.é †è±åˆ°ä»˜ ( æ™ºèƒ½æ«ƒ / SFé–€å¸‚ )\nðŸ§šðŸ»â€â™€ï¸æ”¶ä»¶äºº: Karen Lau \nâ˜Žï¸Tel: 56265394\n é †è±ç·¨ç¢¼: 852UA27P\n2âƒ£ï¸.å¹³éƒµ(é©ç”¨æ–¼è³¼ç‰©æ»¿$300ä»¥ä¸Š\nðŸŒŸè¨»ï¼šéƒµè²»å°‡æ–¼å¯„è²¨å¾Œå†å‘å®¢äººæ”¶å–\nðŸ§šðŸ»â€â™€ï¸æ”¶ä»¶äºº: Karen Lau\n â˜Žï¸Tel: 56265394\nåœ°å€: xxxxxxxxxxxx\nâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\nâš ï¸é¡§å®¢é ˆçŸ¥\n1âƒ£ï¸æ­¤ç‚ºé è¨‚å•†å“ æˆªå–®å¾Œ2-3æ˜ŸæœŸå‡ºè²¨ è«‹è€å¿ƒç­‰å¾…âŒ›ðŸ™ðŸ»\n2âƒ£ï¸è‹¥å‡ºç¾è½å–®å¾Œç¼ºè²¨ç­‰æƒ…æ³ æœƒå‘å®¢äººé€€å›žè©²å•†å“å…¨æ•¸æ¬¾é …\n3âƒ£ï¸å°åº—æœƒè¦ªè‡ªè¯çµ¡é¡§å®¢é€€æ¬¾å®‰æŽ’ðŸ¥º\n \nå¤šè¬ä½ å˜…æ”¯æŒðŸ™ˆä½ å˜…æ”¯æŒæœƒæˆç‚ºæˆ‘åœ°å˜…å‹•åŠ›ðŸ¤")
    else: print("è½å–®è«‹è¼¸å…¥order")

    print("\nðŸ§šðŸ»â€â™€ï¸",order_list,"ðŸ§šðŸ»â€â™€ï¸")
    out_df = pd.DataFrame([order_list])
    from openpyxl import load_workbook
    # new dataframe with same columns
    writer = pd.ExcelWriter('/Users/chunghimlau/Desktop/Python/ck.xlsx',sheet_name = "orderlist", engine='openpyxl')
    # try to open an existing workbook
    writer.book = load_workbook('/Users/chunghimlau/Desktop/Python/ck.xlsx')
    # copy existing sheets
    writer.sheets = dict((ws.title, ws) for ws in writer.book.worksheets)
    # read existing file
    reader = pd.read_excel(r'/Users/chunghimlau/Desktop/Python/ck.xlsx',sheet_name = "orderlist")
    # write out the new sheet
    out_df.to_excel(writer,sheet_name = "orderlist",index=False,header=False,startrow=len(reader)+1)

    writer.close()
    print("**ä¸Šé¢ä¿‚ä½ å˜…è¨‚å–® æ¯ä¸‰æ ¼ä¸€çµ„ å·¦é‚Šä¿‚å•†å“åç¨± ä¸­é–“ä¿‚é¡è‰² å³é‚Šä¿‚Size**")
    print("âš ï¸è«‹ä½ ç‡å“ä¸Šé¢è¨‚å–®å•±å””å•± å†‡å•é¡Œå˜…è«‹å„˜å¿«å…¥æ•¸ å…¥æ•¸å¾Œè¨˜å¾—sendç¿»è­‰æ˜Žæ¯”æˆ‘å“‹ç‡å–âš ï¸ ")
